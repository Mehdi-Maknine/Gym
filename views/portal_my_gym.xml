<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <template id="portal_my_gym_homepage" name="My Gym Portal">
    <t t-call="portal.portal_layout">
      <t t-set="breadcrumbs_searchbar" t-value="True"/>

      <!-- Hero Banner -->
      <section class="position-relative text-white mb-5 rounded overflow-hidden"
               style="background-image: url('/gym_meliora/static/src/img/hero_gym.jpg'); background-size: cover; background-position: center; height: 400px;">
        <div class="position-absolute w-100 h-100" style="background-color: rgba(0,0,0,0.5);"></div>
        <div class="position-relative container h-100 d-flex flex-column justify-content-center align-items-center text-center">
          <h1 class="display-4 fw-bold">🏋️‍♂️ Meliora Gym Portal</h1>
          <p class="lead mb-4">Track your workouts, manage bookings, and smash your goals!</p>
          <a href="/my/gym/sessions" class="btn btn-lg btn-primary px-4 py-2">
            Book Your Next Class
          </a>
        </div>
      </section>

      <div class="container mt-4 mb-5 fade-in">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="d-flex align-items-center gap-3">
            <t t-if="member.partner_id.image_1920">
              <img t-att-src="'data:image/png;base64,%s' % member.partner_id.image_1920"
                  class="rounded-circle shadow-sm mb-3"
                  style="width: 120px; height: 120px; object-fit: cover; border: 2px solid #ccc;"/>
            </t>
            <h2 class="mb-0">Welcome, <t t-esc="request.env.user.name"/> 👋</h2>
          </div>
          <button id="theme-toggle" class="btn btn-sm btn-outline-secondary">
            🌙
          </button>
        </div>


        <!-- Action Cards with Tooltip -->
        <div class="row text-center g-4 mb-5">
          <div class="col-6 col-md-3">
            <a href="/my/gym/sessions" class="btn btn-outline-primary w-100 py-4 shadow-sm" title="Book a new class">
              <i class="fa fa-calendar-check fa-2x mb-2 d-block"></i>
              Book a Session
            </a>
          </div>
          <div class="col-6 col-md-3">
            <a href="/my/gym/attendance" class="btn btn-outline-success w-100 py-4 shadow-sm" title="View your attendance history">
              <i class="fa fa-clock fa-2x mb-2 d-block"></i>
              My Attendance
            </a>
          </div>
          <div class="col-6 col-md-3">
            <a href="/my/gym/invoices" class="btn btn-outline-info w-100 py-4 shadow-sm" title="Check your payment records">
              <i class="fa fa-file-invoice-dollar fa-2x mb-2 d-block"></i>
              Invoices
            </a>
          </div>
          <div class="col-6 col-md-3">
            <a href="/my/gym/dashboard" class="btn btn-outline-warning w-100 py-4 shadow-sm" title="Track your progress and streaks">
              <i class="fa fa-chart-line fa-2x mb-2 d-block"></i>
              My Dashboard
            </a>
          </div>
          <div class="col-6 col-md-3 offset-md-3">
            <a href="/my/gym/profile" class="btn btn-outline-dark w-100 py-4 shadow-sm" title="Update your personal details">
              <i class="fa fa-user-cog fa-2x mb-2 d-block"></i>
              Edit Profile
            </a>
          </div>
        </div>

        <!-- Membership Card -->
        <t t-if="member">
          <div class="card border-0 shadow-sm p-4 position-relative">
            <!-- 🔖 Floating status badge top-right -->
            <span t-attf-class="position-absolute top-0 end-0 badge px-3 py-2 mt-3 me-3 #{'bg-danger' if member.is_membership_expired else 'bg-success'} text-white">
              <t t-if="member.is_membership_expired">⛔</t>
              <t t-if="not member.is_membership_expired">✅</t>
              <t t-esc="member.membership_status_message"/>
            </span>

            <div class="d-flex align-items-center mb-3">
              <i class="fa fa-id-card fa-2x me-3 text-purple"></i>
              <h4 class="mb-0">Your Membership Details</h4>
            </div>
            <div class="row">
              <div class="col-md-4 mb-2">
                <strong>🏷️ Plan:</strong>
                <div><t t-esc="member.membership_plan_id.name"/></div>
              </div>
              <div class="col-md-4 mb-2">
                <strong>📅 Joined on:</strong>
                <div><t t-esc="member.join_date"/></div>
              </div>
              <div class="col-md-4 mb-2">
                <strong>⏳ Valid Until:</strong>
                <div><t t-esc="member.membership_end_date"/></div>
              </div>
              <div class="col-md-6 mt-3">
                <strong>🧑 Assigned Trainer:</strong>
                <div><t t-esc="member.trainer_id.name or 'Not assigned'"/></div>
              </div>
            </div>
          </div>
        </t>

        <t t-if="not member">
          <div class="alert alert-warning mt-4">You don't seem to have a gym membership yet.</div>
        </t>
      </div>
    </t>
  </template>
</odoo>
